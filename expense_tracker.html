<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expense Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="min-h-screen bg-gradient-to-br from-green-50 to-teal-100">
    <div class="container mx-auto p-6 max-w-6xl">
        <h1 class="text-4xl font-bold text-gray-800 mb-2">üí∞ Expense Tracker</h1>
        <p class="text-gray-600 mb-8">Manage your personal finances</p>

        <!-- Summary Cards -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
            <div class="bg-white rounded-lg shadow p-4">
                <p class="text-gray-600 text-sm">Total Income</p>
                <p class="text-3xl font-bold text-green-600">$<span id="total-income">0</span></p>
            </div>
            <div class="bg-white rounded-lg shadow p-4">
                <p class="text-gray-600 text-sm">Total Expenses</p>
                <p class="text-3xl font-bold text-red-600">$<span id="total-expenses">0</span></p>
            </div>
            <div class="bg-white rounded-lg shadow p-4">
                <p class="text-gray-600 text-sm">Balance</p>
                <p class="text-3xl font-bold text-blue-600">$<span id="balance">0</span></p>
            </div>
            <div class="bg-white rounded-lg shadow p-4">
                <p class="text-gray-600 text-sm">This Month</p>
                <p class="text-3xl font-bold text-purple-600">$<span id="month-expenses">0</span></p>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Add Transaction Form -->
            <div class="lg:col-span-1">
                <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                    <h2 class="text-xl font-semibold mb-4">Add Transaction</h2>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm text-gray-600 mb-1">Type</label>
                            <select id="type" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                                <option value="expense">Expense</option>
                                <option value="income">Income</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm text-gray-600 mb-1">Description</label>
                            <input type="text" id="description" placeholder="e.g., Groceries" 
                                class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                        </div>
                        <div>
                            <label class="block text-sm text-gray-600 mb-1">Amount</label>
                            <input type="number" id="amount" placeholder="0.00" step="0.01" 
                                class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                        </div>
                        <div>
                            <label class="block text-sm text-gray-600 mb-1">Category</label>
                            <select id="category" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                                <option value="food">üçî Food & Dining</option>
                                <option value="transport">üöó Transportation</option>
                                <option value="shopping">üõçÔ∏è Shopping</option>
                                <option value="entertainment">üé¨ Entertainment</option>
                                <option value="bills">üí° Bills & Utilities</option>
                                <option value="health">‚öïÔ∏è Healthcare</option>
                                <option value="salary">üíº Salary</option>
                                <option value="other">üìå Other</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm text-gray-600 mb-1">Date</label>
                            <input type="date" id="date" 
                                class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500">
                        </div>
                        <button onclick="addTransaction()" class="w-full bg-green-600 text-white py-2 rounded hover:bg-green-700 font-semibold">
                            Add Transaction
                        </button>
                    </div>
                </div>

                <!-- Chart -->
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="font-semibold mb-4">Expenses by Category</h3>
                    <canvas id="expenseChart"></canvas>
                </div>
            </div>

            <!-- Transactions List -->
            <div class="lg:col-span-2">
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-semibold">Recent Transactions</h2>
                        <select id="filter" onchange="renderTransactions()" class="border border-gray-300 rounded px-3 py-2 text-sm">
                            <option value="all">All</option>
                            <option value="expense">Expenses</option>
                            <option value="income">Income</option>
                        </select>
                    </div>
                    <div id="transactions-list" class="space-y-2 max-h-[600px] overflow-y-auto">
                        <p class="text-gray-500 text-center py-8">No transactions yet. Add your first transaction!</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let transactions = [];
        let chart = null;

        function loadData() {
            const saved = localStorage.getItem('transactions');
            if (saved) {
                transactions = JSON.parse(saved);
                renderTransactions();
                updateSummary();
                updateChart();
            }
        }

        function saveData() {
            localStorage.setItem('transactions', JSON.stringify(transactions));
        }

        function addTransaction() {
            const type = document.getElementById('type').value;
            const description = document.getElementById('description').value.trim();
            const amount = parseFloat(document.getElementById('amount').value);
            const category = document.getElementById('category').value;
            const date = document.getElementById('date').value || new Date().toISOString().split('T')[0];

            if (!description || !amount || amount <= 0) {
                alert('Please fill in all fields with valid values');
                return;
            }

            const transaction = {
                id: Date.now(),
                type,
                description,
                amount,
                category,
                date
            };

            transactions.unshift(transaction);
            saveData();
            renderTransactions();
            updateSummary();
            updateChart();
            clearForm();
        }

        function deleteTransaction(id) {
            transactions = transactions.filter(t => t.id !== id);
            saveData();
            renderTransactions();
            updateSummary();
            updateChart();
        }

        function clearForm() {
            document.getElementById('description').value = '';
            document.getElementById('amount').value = '';
            document.getElementById('date').value = '';
        }

        function renderTransactions() {
            const filter = document.getElementById('filter').value;
            const filtered = filter === 'all' ? transactions : transactions.filter(t => t.type === filter);
            const list = document.getElementById('transactions-list');

            if (filtered.length === 0) {
                list.innerHTML = '<p class="text-gray-500 text-center py-8">No transactions found</p>';
                return;
            }

            const categoryIcons = {
                food: 'üçî', transport: 'üöó', shopping: 'üõçÔ∏è', entertainment: 'üé¨',
                bills: 'üí°', health: '‚öïÔ∏è', salary: 'üíº', other: 'üìå'
            };

            list.innerHTML = filtered.map(t => `
                <div class="flex items-center justify-between p-4 border border-gray-200 rounded hover:bg-gray-50">
                    <div class="flex items-center gap-3">
                        <div class="text-2xl">${categoryIcons[t.category]}</div>
                        <div>
                            <p class="font-semibold text-gray-800">${t.description}</p>
                            <p class="text-sm text-gray-500">${t.date} ‚Ä¢ ${t.category}</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-4">
                        <span class="text-lg font-bold ${t.type === 'income' ? 'text-green-600' : 'text-red-600'}">
                            ${t.type === 'income' ? '+' : '-'}$${t.amount.toFixed(2)}
                        </span>
                        <button onclick="deleteTransaction(${t.id})" class="text-red-500 hover:text-red-700">
                            üóëÔ∏è
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function updateSummary() {
            const income = transactions.filter(t => t.type === 'income').reduce((sum, t) => sum + t.amount, 0);
            const expenses = transactions.filter(t => t.type === 'expense').reduce((sum, t) => sum + t.amount, 0);
            const balance = income - expenses;

            // This month's expenses
            const now = new Date();
            const currentMonth = now.getMonth();
            const currentYear = now.getFullYear();
            const monthExpenses = transactions.filter(t => {
                const tDate = new Date(t.date);
                return t.type === 'expense' && tDate.getMonth() === currentMonth && tDate.getFullYear() === currentYear;
            }).reduce((sum, t) => sum + t.amount, 0);

            document.getElementById('total-income').textContent = income.toFixed(2);
            document.getElementById('total-expenses').textContent = expenses.toFixed(2);
            document.getElementById('balance').textContent = balance.toFixed(2);
            document.getElementById('month-expenses').textContent = monthExpenses.toFixed(2);
        }

        function updateChart() {
            const expensesByCategory = {};
            transactions.filter(t => t.type === 'expense').forEach(t => {
                expensesByCategory[t.category] = (expensesByCategory[t.category] || 0) + t.amount;
            });

            const categories = Object.keys(expensesByCategory);
            const amounts = Object.values(expensesByCategory);

            const ctx = document.getElementById('expenseChart');
            
            if (chart) {
                chart.destroy();
            }

            if (categories.length === 0) {
                return;
            }

            chart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: categories.map(c => c.charAt(0).toUpperCase() + c.slice(1)),
                    datasets: [{
                        data: amounts,
                        backgroundColor: [
                            '#EF4444', '#F59E0B', '#10B981', '#3B82F6',
                            '#8B5CF6', '#EC4899', '#6366F1', '#14B8A6'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // Initialize date to today
        document.getElementById('date').valueAsDate = new Date();

        // Load data on page load
        loadData();
    </script>
</body>
</html>